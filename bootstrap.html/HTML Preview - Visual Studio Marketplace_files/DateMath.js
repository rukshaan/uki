define("OfficeFabric/utilities/dateMath/DateMath",["require","exports","../dateValues/DateValues","../dateValues/TimeConstants","../../Utilities"],function(n,t,i,r,u){"use strict";function f(n,t){var i=new Date(n.getTime());return i.setDate(i.getDate()+t),i}function v(n,t){return f(n,t*r.default.DaysInOneWeek)}function e(n,t){var i=new Date(n.getTime()),u=i.getMonth()+t;return i.setMonth(u),i.getMonth()!==(u%r.default.MonthInOneYear+r.default.MonthInOneYear)%r.default.MonthInOneYear&&(i=f(i,-i.getDate())),i}function y(n,t){var i=new Date(n.getTime());return i.setFullYear(n.getFullYear()+t),i.getMonth()!==(n.getMonth()%r.default.MonthInOneYear+r.default.MonthInOneYear)%r.default.MonthInOneYear&&(i=f(i,-i.getDate())),i}function p(n){return new Date(n.getFullYear(),n.getMonth(),1,0,0,0,0)}function w(n){return new Date(n.getFullYear(),n.getMonth()+1,0,0,0,0,0)}function b(n){return new Date(n.getFullYear(),0,1,0,0,0,0)}function k(n){return new Date(n.getFullYear()+1,0,0,0,0,0,0)}function d(n,t){return e(n,t-n.getMonth())}function o(n,t){return n||t?n&&t?n.getFullYear()===t.getFullYear()&&n.getMonth()===t.getMonth()&&n.getDate()===t.getDate():!1:!0}function g(n,t){return l(n)-l(t)}function nt(n,t,s,h){var y=[],l,v=null,a;h||(h=[i.DayOfWeek.Monday,i.DayOfWeek.Tuesday,i.DayOfWeek.Wednesday,i.DayOfWeek.Thursday,i.DayOfWeek.Friday]);switch(t){case i.DateRangeType.Day:l=c(n);v=f(l,1);break;case i.DateRangeType.Week:case i.DateRangeType.WorkWeek:l=rt(c(n),s);v=f(l,r.default.DaysInOneWeek);break;case i.DateRangeType.Month:l=new Date(n.getFullYear(),n.getMonth(),1);v=e(l,1);break;default:return u.assertNever(t)}a=l;do t!==i.DateRangeType.WorkWeek?y.push(a):h.includes(a.getDay())&&y.push(a),a=f(a,1);while(!o(a,v));return y}function tt(n,t){for(var u,i=0,r=t;i<r.length;i++)if(u=r[i],o(n,u))return!0;return!1}function it(n,t,i,u){var e=u.getFullYear(),o=u.getMonth(),f=1,a=new Date(e,o,f),v=f+(t+r.default.DaysInOneWeek-1)-ft(t,a.getDay()),s=new Date(e,o,v),c,l;for(f=s.getDate(),c=[],l=0;l<n;l++)c.push(h(s,t,i)),f+=r.default.DaysInOneWeek,s=new Date(e,o,f);return c}function h(n,t,u){switch(u){case i.FirstWeekOfYear.FirstFullWeek:return a(n,t,r.default.DaysInOneWeek);case i.FirstWeekOfYear.FirstFourDayWeek:return a(n,t,4);default:return ut(n,t)}}function c(n){return new Date(n.getFullYear(),n.getMonth(),n.getDate())}function rt(n,t){var i=t-n.getDay();return i>0&&(i-=r.default.DaysInOneWeek),f(n,i)}function l(n){return n.getDate()+(n.getMonth()<<5)+(n.getFullYear()<<9)}function a(n,t,u){var h=s(n)-1,o=n.getDay()-h%r.default.DaysInOneWeek,l=new Date(n.getFullYear()-1,i.MonthOfYear.December,31),c=s(l)-1,f=(t-o+2*r.default.DaysInOneWeek)%r.default.DaysInOneWeek,e;return f!==0&&f>=u&&(f-=r.default.DaysInOneWeek),e=h-f,e<0&&(o-=c%r.default.DaysInOneWeek,f=(t-o+2*r.default.DaysInOneWeek)%r.default.DaysInOneWeek,f!==0&&f+1>=u&&(f-=r.default.DaysInOneWeek),e=c-f),Math.floor(e/r.default.DaysInOneWeek+1)}function ut(n,t){var i=s(n)-1,u=n.getDay()-i%r.default.DaysInOneWeek,f=(u-t+2*r.default.DaysInOneWeek)%r.default.DaysInOneWeek;return Math.floor((i+f)/r.default.DaysInOneWeek+1)}function ft(n,t){return n!==i.DayOfWeek.Sunday&&t<n?t+r.default.DaysInOneWeek:t}function s(n){for(var r=n.getMonth(),u=n.getFullYear(),i=0,t=0;t<r;t++)i+=et(t+1,u);return i+n.getDate()}function et(n,t){return new Date(t,n,0).getDate()}Object.defineProperty(t,"__esModule",{value:!0});t.addDays=f;t.addWeeks=v;t.addMonths=e;t.addYears=y;t.getMonthStart=p;t.getMonthEnd=w;t.getYearStart=b;t.getYearEnd=k;t.setMonth=d;t.compareDates=o;t.compareDatePart=g;t.getDateRangeArray=nt;t.isInDateRangeArray=tt;t.getWeekNumbersInMonth=it;t.getWeekNumber=h});

