define("OfficeFabric/components/DatePicker/DatePicker",["require","exports","tslib","react","../../Calendar","../../utilities/dateValues/DateValues","../../Callout","../../TextField","../../Utilities","../../utilities/dateMath/DateMath","./DatePicker.scss","../../FocusTrapZone"],function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=c,v={months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["S","M","T","W","T","F","S"],goToToday:"Go to today",prevMonthAriaLabel:"Go to previous month",nextMonthAriaLabel:"Go to next month",prevYearAriaLabel:"Go to previous year",nextYearAriaLabel:"Go to next year"},y=function(n){function t(t){var i=n.call(this,t)||this;return i._calendar=s.createRef(),i._datePickerDiv=s.createRef(),i._textField=s.createRef(),i._onSelectDate=function(n){var t=i.props,r=t.formatDate,u=t.onSelectDate;if(i.props.calendarProps&&i.props.calendarProps.onSelectDate)i.props.calendarProps.onSelectDate(n);i.setState({selectedDate:n,formattedDate:r&&n?r(n):""});u&&u(n);i._calendarDismissed()},i._onCalloutPositioned=function(){i._calendar.current&&!i.props.disableAutoFocus&&i._calendar.current.focus()},i._onTextFieldFocus=function(){i.props.disableAutoFocus||i.props.allowTextInput||(i._preventFocusOpeningPicker?i._preventFocusOpeningPicker=!1:i._showDatePickerPopup())},i._onTextFieldBlur=function(){i._validateTextInput()},i._onTextFieldChanged=function(n){if(i.props.allowTextInput){i.state.isDatePickerShown&&i._dismissDatePickerPopup();var t=i.props,r=t.isRequired,u=t.value,f=t.strings;i.setState({errorMessage:r&&!u?f.isRequiredErrorMessage||" ":undefined,formattedDate:n})}},i._onTextFieldKeyDown=function(n){switch(n.which){case 13:n.preventDefault();n.stopPropagation();i.state.isDatePickerShown?i.props.allowTextInput&&i._dismissDatePickerPopup():i._showDatePickerPopup();break;case 27:i._handleEscKey(n)}},i._onTextFieldClick=function(){i.state.isDatePickerShown||i.props.disabled?i.props.allowTextInput&&i.setState({isDatePickerShown:!1}):i._showDatePickerPopup()},i._onIconClick=function(n){n.stopPropagation();i._onTextFieldClick(n)},i._dismissDatePickerPopup=function(){i.state.isDatePickerShown&&(i.setState({isDatePickerShown:!1}),i._validateTextInput())},i._calendarDismissed=function(){i._preventFocusOpeningPicker=!0;i._dismissDatePickerPopup()},i._handleEscKey=function(n){n.stopPropagation();i._calendarDismissed()},i._validateTextInput=function(){var t=i.props,o=t.isRequired,s=t.allowTextInput,f=t.strings,h=t.parseDateFromString,e=t.onSelectDate,r=t.formatDate,c=t.minDate,l=t.maxDate,u=i.state.formattedDate,n;if(!i.state.isDatePickerShown){if(o&&!u){i.setState({errorMessage:f.isRequiredErrorMessage||" "});return}s&&(n=null,u?i.state.selectedDate&&r&&r(i.state.selectedDate)===u?n=i.state.selectedDate:(n=h(u),!n||isNaN(n.getTime())?(r&&(n=i.state.selectedDate,i.setState({formattedDate:r(n).toString()})),i.setState({errorMessage:f.invalidInputErrorMessage||" "})):i._isDateOutOfBounds(n,c,l)?i.setState({errorMessage:f.isOutOfBoundsErrorMessage||" "}):(i.setState({selectedDate:n,errorMessage:""}),r&&r(n)!==u&&i.setState({formattedDate:r(n).toString()}))):i.setState({errorMessage:""}),e&&e(n))}},i.state=i._getDefaultState(),i._preventFocusOpeningPicker=!1,i}return i.__extends(t,n),t.prototype.componentWillReceiveProps=function(n){var i=n.formatDate,e=n.isRequired,u=n.strings,t=n.value,o=n.minDate,s=n.maxDate,r,f;h.compareDates(this.props.minDate,n.minDate)&&h.compareDates(this.props.maxDate,n.maxDate)&&this.props.isRequired===n.isRequired&&h.compareDates(this.state.selectedDate,t)&&this.props.formatDate===i||(r=e&&!t?u.isRequiredErrorMessage||" ":undefined,!r&&t&&(r=this._isDateOutOfBounds(t,o,s)?u.isOutOfBoundsErrorMessage||" ":undefined),this.setState({errorMessage:r}),f=this.state.selectedDate,h.compareDates(f,t)&&this.props.formatDate===i||this.setState({selectedDate:t||undefined,formattedDate:i&&t?i(t):""}))},t.prototype.componentDidUpdate=function(n,t){this.props.onAfterMenuDismiss&&t.isDatePickerShown&&!this.state.isDatePickerShown&&this.props.onAfterMenuDismiss()},t.prototype.render=function(){var n=this.props,v=n.firstDayOfWeek,y=n.strings,f=n.label,p=n.initialPickerDate,w=n.isRequired,c=n.disabled,b=n.ariaLabel,k=n.pickerAriaLabel,d=n.placeholder,g=n.allowTextInput,nt=n.borderless,tt=n.className,it=n.minDate,rt=n.maxDate,ut=n.calendarProps,t=this.state,h=t.isDatePickerShown,ft=t.formattedDate,et=t.selectedDate,ot=t.errorMessage;return r.createElement("div",{className:s.css("ms-DatePicker",a.root,h&&"is-open",tt)},r.createElement("div",{ref:this._datePickerDiv},r.createElement(o.TextField,{label:f,className:a.textField,ariaLabel:b,"aria-haspopup":"true","aria-expanded":h,required:w,disabled:c,onKeyDown:this._onTextFieldKeyDown,onFocus:this._onTextFieldFocus,onBlur:this._onTextFieldBlur,onClick:this._onTextFieldClick,onChanged:this._onTextFieldChanged,errorMessage:ot,placeholder:d,borderless:nt,iconProps:{iconName:"Calendar",onClick:this._onIconClick,className:s.css(c&&a.msDatePickerDisabled,f?"ms-DatePicker-event--with-label":"ms-DatePicker-event--without-label",f?a.eventWithLabel:a.eventWithoutLabel)},readOnly:!g,value:ft,componentRef:this._textField,role:"button"})),h&&r.createElement(e.Callout,{role:"dialog",ariaLabel:k,isBeakVisible:!1,className:s.css("ms-DatePicker-callout"),gapSpace:0,doNotLayer:!1,target:this._datePickerDiv.current,directionalHint:4,onDismiss:this._calendarDismissed,onPositioned:this._onCalloutPositioned},r.createElement(l.FocusTrapZone,{isClickableOutsideFocusTrap:!0,disableFirstFocus:this.props.disableAutoFocus},r.createElement(u.Calendar,i.__assign({},ut,{onSelectDate:this._onSelectDate,onDismiss:this._calendarDismissed,isMonthPickerVisible:this.props.isMonthPickerVisible,showMonthPickerAsOverlay:this.props.showMonthPickerAsOverlay,today:this.props.today,value:et||p,firstDayOfWeek:v,strings:y,highlightCurrentMonth:this.props.highlightCurrentMonth,highlightSelectedMonth:this.props.highlightSelectedMonth,showWeekNumbers:this.props.showWeekNumbers,firstWeekOfYear:this.props.firstWeekOfYear,showGoToToday:this.props.showGoToToday,dateTimeFormatter:this.props.dateTimeFormatter,minDate:it,maxDate:rt,componentRef:this._calendar})))))},t.prototype.focus=function(){this._textField.current&&this._textField.current.focus()},t.prototype.reset=function(){this.setState(this._getDefaultState())},t.prototype._showDatePickerPopup=function(){this.state.isDatePickerShown||(this._preventFocusOpeningPicker=!0,this.setState({isDatePickerShown:!0,errorMessage:""}))},t.prototype._getDefaultState=function(n){return n===void 0&&(n=this.props),{selectedDate:n.value||undefined,formattedDate:n.formatDate&&n.value?n.formatDate(n.value):"",isDatePickerShown:!1,errorMessage:undefined}},t.prototype._isDateOutOfBounds=function(n,t,i){return!!t&&h.compareDatePart(t,n)>0||!!i&&h.compareDatePart(i,n)<0},t.defaultProps={allowTextInput:!1,formatDate:function(n){return n?n.toDateString():""},parseDateFromString:function(n){var t=Date.parse(n);return t?new Date(t):null},firstDayOfWeek:u.DayOfWeek.Sunday,initialPickerDate:new Date,isRequired:!1,isMonthPickerVisible:!0,showMonthPickerAsOverlay:!1,strings:v,highlightCurrentMonth:!1,highlightSelectedMonth:!1,borderless:!1,pickerAriaLabel:"Calender",showWeekNumbers:!1,firstWeekOfYear:f.FirstWeekOfYear.FirstDay,showGoToToday:!0,dateTimeFormatter:undefined},t}(s.BaseComponent);t.DatePicker=y});

