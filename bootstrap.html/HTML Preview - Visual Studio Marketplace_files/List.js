define("OfficeFabric/components/List/List",["require","exports","tslib","react","../../Utilities"],function(n,t,i,r,u){"use strict";function o(n,t,i){var r=n.top-t*n.height,u=n.height+(t+i)*n.height;return{top:r,bottom:r+u,height:u,left:n.left,right:n.right,width:n.width}}function g(n,t){return n.top>=t.top&&n.left>=t.left&&n.bottom<=t.bottom&&n.right<=t.right}function nt(n,t){return n.top=t.top<n.top||n.top===-1?t.top:n.top,n.left=t.left<n.left||n.left===-1?t.left:n.left,n.bottom=t.bottom>n.bottom||n.bottom===-1?t.bottom:n.bottom,n.right=t.right>n.right||n.right===-1?t.right:n.right,n.width=n.right-n.left+1,n.height=n.bottom-n.top+1,n}Object.defineProperty(t,"__esModule",{value:!0});var s=16,h=100,c=500,l=200,a=500,f=10,v=30,y=2,p=2,w={top:-1,bottom:-1,left:-1,right:-1,width:0,height:0},e=function(n){return n.getBoundingClientRect()},b=e,k=e,d=function(n){function t(t){var f=n.call(this,t)||this;return f._root=u.createRef(),f._surface=u.createRef(),f._onRenderPage=function(n){var t=f.props,e=t.onRenderCell,s=t.role,o=n.page,h=o.items,c=o.startIndex,l=i.__rest(n,["page"]),a=s===undefined?"listitem":"presentation",v=(h||[]).map(function(n,t){var i=c+t,o=f.props.getKey?f.props.getKey(n,i):n&&n.key;return(o===null||o===undefined)&&(o=i),r.createElement("div",{role:a,className:u.css("ms-List-cell"),key:o,"data-list-index":i,"data-automationid":"ListCell"},e&&e(n,i,f.state.isScrolling))});return r.createElement("div",i.__assign({},l),v)},f.state={pages:[],isScrolling:!1},f._estimatedPageHeight=0,f._totalEstimates=0,f._requiredWindowsAhead=0,f._requiredWindowsBehind=0,f._measureVersion=0,f._onAsyncScroll=f._async.debounce(f._onAsyncScroll,h,{leading:!1,maxWait:c}),f._onAsyncIdle=f._async.debounce(f._onAsyncIdle,l,{leading:!1}),f._onAsyncResize=f._async.debounce(f._onAsyncResize,s,{leading:!1}),f._onScrollingDone=f._async.debounce(f._onScrollingDone,a,{leading:!1}),f._cachedPageHeights={},f._estimatedPageHeight=0,f._focusedIndex=-1,f._pageCache={},f}return i.__extends(t,n),t.prototype.scrollToIndex=function(n,t,i){var u,c,a,v,s,f,y,p,w;i===void 0&&(i=0);var l=this.props.startIndex,b=this._getRenderCount(),d=l+b,g=this._allowedRect,r=0,h=1;for(u=l;u<d;u+=h){if(c=this._getPageSpecification(u,g),a=c.height,h=c.itemCount,v=u<=n&&u+h>n,v){if(t){var e=k(this._scrollElement),o={top:this._scrollElement.scrollTop,bottom:this._scrollElement.scrollTop+e.height},nt=n-u;for(s=0;s<nt;++s)r+=t(u+s);f=r+t(n);switch(i){case 1:this._scrollElement.scrollTop=r;return;case 2:this._scrollElement.scrollTop=f-e.height;return;case 3:this._scrollElement.scrollTop=(r+f-e.height)/2;return}if(y=r>=o.top&&f<=o.bottom,y)return;p=r<o.top;w=f>o.bottom;p||w&&(r=f-e.height)}this._scrollElement.scrollTop=r;return}r+=a}},t.prototype.componentDidMount=function(){this._updatePages();this._measureVersion++;this._scrollElement=u.findScrollableParent(this._root.current);this._events.on(window,"resize",this._onAsyncResize);if(this._root.current)this._events.on(this._root.current,"focus",this._onFocus,!0);if(this._scrollElement){this._events.on(this._scrollElement,"scroll",this._onScroll);this._events.on(this._scrollElement,"scroll",this._onAsyncScroll)}},t.prototype.componentWillReceiveProps=function(n){(n.items!==this.props.items||n.renderCount!==this.props.renderCount||n.startIndex!==this.props.startIndex)&&(this._resetRequiredWindows(),this._requiredRect=null,this._measureVersion++,this._invalidatePageCache(),this._updatePages(n))},t.prototype.shouldComponentUpdate=function(n,t){var r=this.state.pages,o=t.pages,u=!1,i,f,e;if(!t.isScrolling&&this.state.isScrolling)return!0;if(n.items===this.props.items&&r.length===o.length){for(i=0;i<r.length;i++)if(f=r[i],e=o[i],f.key!==e.key||f.itemCount!==e.itemCount){u=!0;break}}else u=!0;return u},t.prototype.forceUpdate=function(){this._invalidatePageCache();this._updateRenderRects(this.props,!0);this._updatePages();this._measureVersion++;n.prototype.forceUpdate.call(this)},t.prototype.render=function(){for(var h,f=this.props,c=f.className,e=f.role,l=e===void 0?"list":e,o=this.state.pages,a=o===void 0?[]:o,n=[],v=u.getNativeProps(this.props,u.divProperties),t=0,s=a;t<s.length;t++)h=s[t],n.push(this._renderPage(h));return r.createElement("div",i.__assign({ref:this._root},v,{role:n.length>0?l:undefined,className:u.css("ms-List",c)}),r.createElement("div",{ref:this._surface,className:u.css("ms-List-surface"),role:"presentation"},n))},t.prototype._shouldVirtualize=function(n){n===void 0&&(n=this.props);var t=n.onShouldVirtualize;return!t||t(n)},t.prototype._invalidatePageCache=function(){this._pageCache={}},t.prototype._renderPage=function(n){var i=this.props.usePageCache,t;if(i&&(t=this._pageCache[n.key],t&&t.pageElement))return t.pageElement;var e=this._getPageStyle(n),r=this.props.onRenderPage,o=r===void 0?this._onRenderPage:r,f=o({page:n,className:u.css("ms-List-page"),key:n.key,ref:n.key,style:e,role:"presentation"},this._onRenderPage);return i&&n.startIndex===0&&(this._pageCache[n.key]={page:n,pageElement:f}),f},t.prototype._getPageStyle=function(n){var t=this.props.getPageStyle;return i.__assign({},t?t(n):{},n.items?{}:{height:n.height})},t.prototype._onFocus=function(n){for(var t=n.target,i;t!==this._surface.current;){if(i=t.getAttribute("data-list-index"),i){this._focusedIndex=Number(i);break}t=u.getParent(t)}},t.prototype._onScroll=function(){this.state.isScrolling||this.setState({isScrolling:!0});this._resetRequiredWindows();this._onScrollingDone()},t.prototype._resetRequiredWindows=function(){this._requiredWindowsAhead=0;this._requiredWindowsBehind=0},t.prototype._onAsyncScroll=function(){this._updateRenderRects();this._materializedRect&&g(this._requiredRect,this._materializedRect)||this._updatePages()},t.prototype._onAsyncIdle=function(){var i=this.props,r=i.renderedWindowsAhead,u=i.renderedWindowsBehind,f=this,e=f._requiredWindowsAhead,o=f._requiredWindowsBehind,n=Math.min(r,e+1),t=Math.min(u,o+1);(n!==e||t!==o)&&(this._requiredWindowsAhead=n,this._requiredWindowsBehind=t,this._updateRenderRects(),this._updatePages());(r>n||u>t)&&this._onAsyncIdle()},t.prototype._onScrollingDone=function(){this.setState({isScrolling:!1})},t.prototype._onAsyncResize=function(){this.forceUpdate()},t.prototype._updatePages=function(n){var t=this,i,r;n===void 0&&(n=this.props);this._requiredRect||this._updateRenderRects(n);i=this._buildPages(n);r=this.state.pages;this._notifyPageChanges(r,i.pages);this.setState(i,function(){if(n.getPageHeight)t._onAsyncIdle();else{var r=t._updatePageMeasurements(i.pages);r?(t._materializedRect=null,t._hasCompletedFirstRender?t._onAsyncScroll():(t._hasCompletedFirstRender=!0,t._updatePages(n))):t._onAsyncIdle()}})},t.prototype._notifyPageChanges=function(n,t,i){var c,l,u,f,o,e,s,r,h;if(i===void 0&&(i=this.props),c=i.onPageAdded,l=i.onPageRemoved,c||l){for(u={},f=0,o=n;f<o.length;f++)r=o[f],r.items&&(u[r.startIndex]=r);for(e=0,s=t;e<s.length;e++)r=s[e],r.items&&(u[r.startIndex]?delete u[r.startIndex]:this._onPageAdded(r));for(h in u)u.hasOwnProperty(h)&&this._onPageRemoved(u[h])}},t.prototype._updatePageMeasurements=function(n){var t=!1,i,r;if(!this._shouldVirtualize())return t;for(i=0;i<n.length;i++)r=n[i],r.items&&(t=this._measurePage(r)||t);return t},t.prototype._measurePage=function(n){var r=!1,i=this.refs[n.key],u=this._cachedPageHeights[n.startIndex],t;return i&&this._shouldVirtualize()&&(!u||u.measureVersion!==this._measureVersion)&&(t={width:i.clientWidth,height:i.clientHeight},(t.height||t.width)&&(r=n.height!==t.height,n.height=t.height,this._cachedPageHeights[n.startIndex]={height:t.height,measureVersion:this._measureVersion},this._estimatedPageHeight=Math.round((this._estimatedPageHeight*this._totalEstimates+t.height)/(this._totalEstimates+1)),this._totalEstimates++)),r},t.prototype._onPageAdded=function(n){var t=this.props.onPageAdded;t&&t(n)},t.prototype._onPageRemoved=function(n){var t=this.props.onPageRemoved;t&&t(n)},t.prototype._buildPages=function(n){var l=n.renderCount,d=n.items,c=n.startIndex,g=n.getPageHeight,h,k;l=this._getRenderCount(n);var a=i.__assign({},w),s=[],o=1,r=0,t=null,v=this._focusedIndex,y=c+l,p=this._shouldVirtualize(n),b=this._estimatedPageHeight===0&&!g,e=this._allowedRect,tt=function(n){var h=f._getPageSpecification(n,e),w=h.height,k=h.data,it=h.key,tt,l;o=h.itemCount;var i=r+w-1,rt=u.findIndex(f.state.pages,function(t){return!!t.items&&t.startIndex===n})>-1,ut=!e||i>=e.top&&r<=e.bottom,g=!f._requiredRect||i>=f._requiredRect.top&&r<=f._requiredRect.bottom,ft=!b&&(g||ut&&rt)||!p,et=v>=n&&v<n+o,ot=n===c;return ft||et||ot?(t&&(s.push(t),t=null),tt=Math.min(o,y-n),l=f._createPage(it,d.slice(n,n+tt),n,undefined,undefined,k),l.top=r,l.height=w,s.push(l),g&&f._allowedRect&&nt(a,{top:r,bottom:i,height:w,left:e.left,right:e.right,width:e.width})):(t||(t=f._createPage("spacer-"+n,undefined,n,0,undefined,k)),t.height=(t.height||0)+(i-r)+1,t.itemCount+=o),r+=i-r+1,b&&p?"break":void 0},f=this;for(h=c;h<y;h+=o)if(k=tt(h),k==="break")break;return t&&(t.key="spacer-end",s.push(t)),this._materializedRect=a,{pages:s,measureVersion:this._measureVersion}},t.prototype._getPageSpecification=function(n,t){var u=this.props.getPageSpecification,i;if(u){var r=u(n,t),f=r.itemCount,i=f===void 0?this._getItemCountForPage(n,t):f,e=r.height,o=e===void 0?this._getPageHeight(n,i,t):e;return{itemCount:i,height:o,data:r.data,key:r.key}}return i=this._getItemCountForPage(n,t),{itemCount:i,height:this._getPageHeight(n,i,t)}},t.prototype._getPageHeight=function(n,t,i){if(this.props.getPageHeight)return this.props.getPageHeight(n,i);var r=this._cachedPageHeights[n];return r?r.height:this._estimatedPageHeight||v},t.prototype._getItemCountForPage=function(n,t){var i=this.props.getItemCountForPage?this.props.getItemCountForPage(n,t):f;return i?i:f},t.prototype._createPage=function(n,t,i,r,u,f){var o,e;if(i===void 0&&(i=-1),r===void 0&&(r=t?t.length:0),u===void 0&&(u={}),f===void 0&&(f=undefined),n=n||"page-"+i,o=this._pageCache[n],o&&o.page)return o.page;if(t)for(e=0;e<t.length;e++)t[e]=t[e]||undefined;return{key:n,startIndex:i,itemCount:r,items:t,style:u||{},top:0,height:0,data:f}},t.prototype._getRenderCount=function(n){var t=n||this.props,i=t.items,u=t.startIndex,r=t.renderCount;return r===undefined?i?i.length-u:0:r},t.prototype._updateRenderRects=function(n,t){var u,f;n=n||this.props;var s=n.renderedWindowsAhead,h=n.renderedWindowsBehind,c=this.state.pages;if(this._shouldVirtualize(n)){var i=this._surfaceRect,r=this._scrollElement&&this._scrollElement.scrollHeight,e=this._scrollElement?this._scrollElement.scrollTop:0;this._surface.current&&(t||!c||!this._surfaceRect||!r||r!==this._scrollHeight||Math.abs(this._scrollTop-e)>this._estimatedPageHeight/3)&&(i=this._surfaceRect=b(this._surface.current),this._scrollTop=e);(t||!r||r!==this._scrollHeight)&&this._measureVersion++;this._scrollHeight=r;u=Math.max(0,-i.top);f={top:u,left:i.left,bottom:u+window.innerHeight,right:i.right,width:i.width,height:window.innerHeight};this._requiredRect=o(f,this._requiredWindowsBehind,this._requiredWindowsAhead);this._allowedRect=o(f,h,s)}},t.defaultProps={startIndex:0,onRenderCell:function(n){return r.createElement("div",null,n&&n.name||"")},renderedWindowsAhead:p,renderedWindowsBehind:y},t}(u.BaseComponent);t.List=d});

