define("OfficeFabric/components/GroupedList/GroupedListSection",["require","exports","tslib","react","../../Utilities","../../utilities/selection/index","./GroupHeader","./GroupShowAll","./GroupFooter","../../List","../../Utilities","./GroupedList.scss"],function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=l,v="is-dropping",y=function(n){function t(f){var h=n.call(this,f)||this,l,c;return h._root=u.createRef(),h._list=u.createRef(),h._onRenderGroupHeader=function(n){return r.createElement(e.GroupHeader,i.__assign({},n))},h._onRenderGroupShowAll=function(n){return r.createElement(o.GroupShowAll,i.__assign({},n))},h._onRenderGroupFooter=function(n){return r.createElement(s.GroupFooter,i.__assign({},n))},h._renderSubGroup=function(n,i){var u=h.props,f=u.dragDropEvents,e=u.dragDropHelper,o=u.eventsToRegister,s=u.getGroupItemLimit,c=u.groupNestingDepth,l=u.items,a=u.headerProps,v=u.showAllProps,y=u.footerProps,p=u.listProps,w=u.onRenderCell,b=u.selection,k=u.selectionMode,d=u.viewport,g=u.onRenderGroupHeader,nt=u.onRenderGroupShowAll,tt=u.onRenderGroupFooter,it=u.onShouldVirtualize;return!n||n.count>0?r.createElement(t,{ref:"subGroup_"+i,key:h._getGroupKey(n,i),dragDropEvents:f,dragDropHelper:e,eventsToRegister:o,footerProps:y,getGroupItemLimit:s,group:n,groupIndex:i,groupNestingDepth:c,headerProps:a,items:l,listProps:p,onRenderCell:w,selection:b,selectionMode:k,showAllProps:v,viewport:d,onRenderGroupHeader:g,onRenderGroupShowAll:nt,onRenderGroupFooter:tt,onShouldVirtualize:it}):null},h._getGroupDragDropOptions=function(){var n=h.props,t=n.group,i=n.groupIndex,r=n.dragDropEvents,u=n.eventsToRegister;return{eventMap:u,selectionIndex:-1,context:{data:t,index:i,isGroup:!0},canDrag:function(){return!1},canDrop:r.canDrop,updateDropState:h._updateDroppingState}},h._updateDroppingState=function(n,t){var r=h.state.isDropping,i=h.props.dragDropEvents;if(r){if(i&&i.onDragEnter)i.onDragEnter(t,undefined)}else if(i&&i.onDragLeave)i.onDragLeave(t,undefined);r!==n&&h.setState({isDropping:n})},l=f.selection,c=f.group,h.state={isDropping:!1,isSelected:l&&c?l.isRangeSelected(c.startIndex,c.count):!1},h}return i.__extends(t,n),t.prototype.componentDidMount=function(){var n=this.props,t=n.dragDropHelper,i=n.selection;if(t&&this._root.current&&(this._dragDropSubscription=t.subscribe(this._root.current,this._events,this._getGroupDragDropOptions())),i)this._events.on(i,f.SELECTION_CHANGE,this._onSelectionChange)},t.prototype.componentWillUnmount=function(){this._dragDropSubscription&&this._dragDropSubscription.dispose()},t.prototype.componentDidUpdate=function(n){(this.props.group!==n.group||this.props.groupIndex!==n.groupIndex||this.props.dragDropHelper!==n.dragDropHelper)&&(this._dragDropSubscription&&(this._dragDropSubscription.dispose(),delete this._dragDropSubscription),this.props.dragDropHelper&&this._root.current&&(this._dragDropSubscription=this.props.dragDropHelper.subscribe(this._root.current,this._events,this._getGroupDragDropOptions())))},t.prototype.render=function(){var t=this.props,u=t.getGroupItemLimit,n=t.group,l=t.groupIndex,v=t.headerProps,y=t.showAllProps,p=t.footerProps,w=t.viewport,b=t.selectionMode,f=t.onRenderGroupHeader,k=f===void 0?this._onRenderGroupHeader:f,e=t.onRenderGroupShowAll,d=e===void 0?this._onRenderGroupShowAll:e,o=t.onRenderGroupFooter,g=o===void 0?this._onRenderGroupFooter:o,nt=t.onShouldVirtualize,tt=this.state.isSelected,s=n&&u?u(n):Infinity,it=n&&!n.children&&!n.isCollapsed&&!n.isShowingAll&&(n.count>s||n.hasMoreData),rt=n&&n.children&&n.children.length>0,i={group:n,groupIndex:l,groupLevel:n?n.level:0,isSelected:tt,viewport:w,selectionMode:b},ut=c.assign({},v,i),ft=c.assign({},y,i),et=c.assign({},p,i);return r.createElement("div",{ref:this._root,className:c.css("ms-GroupedList-group",a.group,this._getDroppingClassName()),role:"presentation"},k(ut,this._onRenderGroupHeader),n&&n.isCollapsed?null:rt?r.createElement(h.List,{ref:this._list,items:n.children,onRenderCell:this._renderSubGroup,getItemCountForPage:this._returnOne,onShouldVirtualize:nt}):this._onRenderGroup(s),n&&n.isCollapsed?null:it&&d(ft,this._onRenderGroupShowAll),g(et,this._onRenderGroupFooter))},t.prototype.forceUpdate=function(){n.prototype.forceUpdate.call(this);this.forceListUpdate()},t.prototype.forceListUpdate=function(){var t=this.props.group,r,i,n;if(this._list.current){if(this._list.current.forceUpdate(),t&&t.children&&t.children.length>0)for(r=t.children.length,i=0;i<r;i++)n=this._list.current.refs["subGroup_"+String(i)],n&&n.forceListUpdate()}else n=this.refs["subGroup_"+String(0)],n&&n.forceListUpdate()},t.prototype._onSelectionChange=function(){var n=this.props,t=n.group,r=n.selection,i=r.isRangeSelected(t.startIndex,t.count);i!==this.state.isSelected&&this.setState({isSelected:i})},t.prototype._onRenderGroupCell=function(n,t){return function(i,r){return n(t,i,r)}},t.prototype._onRenderGroup=function(n){var t=this.props,u=t.group,f=t.items,e=t.onRenderCell,o=t.listProps,s=t.groupNestingDepth,c=t.onShouldVirtualize,l=u?u.count:f.length,a=u?u.startIndex:0;return r.createElement(h.List,i.__assign({items:f,onRenderCell:this._onRenderGroupCell(e,s),ref:this._list,renderCount:Math.min(l,n),startIndex:a,onShouldVirtualize:c},o))},t.prototype._returnOne=function(){return 1},t.prototype._getGroupKey=function(n,t){return"group-"+(n&&n.key?n.key:String(n.level)+String(t))},t.prototype._getDroppingClassName=function(){var n=this.state.isDropping,t=this.props.group;return n=!!(t&&n),c.css(n&&v,n&&a.groupIsDropping)},t}(u.BaseComponent);t.GroupedListSection=y});

